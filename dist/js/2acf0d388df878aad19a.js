(()=>{"use strict";var e={d:(t,n)=>{for(var s in n)e.o(n,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:n[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{g:()=>u});class t{constructor(){this.question,this.correctAnswer,this.answers,this.currentQindex}}class n{constructor(){this.unfilteredQuestions,this.filteredQuestions,this.questionCount,this.currentQuestion}static lauchQuestionHandler(){this.fetchQuestionsFromApi().then((e=>{const t=JSON.parse(e);this.storeUnfilteredQuestions(t),this.filterQuestion(65,20,20),this.createCurrentQuestionObj(),this.fetchSingleQuestionFromArray(),this.questionDisplayHandler()})).catch((e=>{console.log(e)}))}static createCurrentQuestionObj(){this.currentQuestion=new t}static fetchQuestionsFromApi(){let e=`https://the-trivia-api.com/v2/questions?limit=40&types=text_choice&categories=${u.topicPage.topic}&difficulties=${u.levelPage.level}`;return new Promise(((t,n)=>{const s=new XMLHttpRequest;s.open("GET",e,!1),s.send(),200===s.status?t(s.response):n(s.status)}))}static storeUnfilteredQuestions(e){this.unfilteredQuestions=e}static fetchSingleQuestionFromArray(){this.currentQuestion.currentQindex||(this.currentQuestion.currentQindex=0),this.questionCount=this.currentQuestion.currentQindex,document.getElementById("q-count-prt1").textContent=`${this.questionCount+1}`,document.getElementById("q-count-prt2").textContent=` /${this.filteredQuestions.length}`;let e=this.currentQuestion.currentQindex;this.currentQuestion.question=this.filteredQuestions[e].question.text,this.currentQuestion.correctAnswer=this.filteredQuestions[e].correctAnswer,this.currentQuestion.answers=this.filteredQuestions[e].incorrectAnswers,this.setAtRandomIndex(this.currentQuestion.correctAnswer),this.currentQuestion.currentQindex++}static setAtRandomIndex(e){const t=Math.floor(5*Math.random());this.currentQuestion.answers.splice(t,0,e)}static questionDisplayHandler(){this.displayQuestion()}static displayQuestion(){document.getElementById("question").textContent=this.currentQuestion.question;const e=document.querySelectorAll("li");for(let t=0;t<e.length;t++)e[t].textContent=this.currentQuestion.answers[t]}static fetchCorrectAnswer(){const e=document.querySelectorAll("li");for(const t of e)if(t.textContent===this.currentQuestion.correctAnswer){t.classList.contains("bubble-selected")&&t.classList.toggle("bubble-selected"),t.classList.toggle("block2__bubble--correctAnswer");break}}static filterQuestion(e,t,n){let s,o;this.filteredQuestions||(this.filteredQuestions=[]);let i,l=!0;for(let c=0;c<this.unfilteredQuestions.length;c++){if(s=this.unfilteredQuestions[c].question.text,i=this.unfilteredQuestions[c].correctAnswer,o=this.unfilteredQuestions[c].incorrectAnswers,i.length<=n){for(let e=0;e<o.length;e++)if(o[e].length>n){l=!1;break}}else l=!1;if(!0===l&&s.length<=e&&this.filteredQuestions.length<t&&(this.filteredQuestions.push(this.unfilteredQuestions[c]),this.filteredQuestions===t))break;l=!0}}}class s{buttonClicked;static makeBubbleSelectable(){const e=document.querySelectorAll("li");for(const t of e)t.addEventListener("click",s.applyBubbleSelectedClass)}static applyBubbleSelectedClass(e){document.querySelector(".bubble-selected")&&document.querySelector(".bubble-selected").classList.remove("bubble-selected"),e.target.classList.toggle("bubble-selected");const t=document.getElementById("button");t.disabled=!1,"game-page"===document.getElementById("page").className?(t.classList.remove("block2__button--disabled"),t.classList.add("block2__button--enabled")):(t.classList.remove("card__button--disabled"),t.classList.add("card__button--enabled"))}static removeBubbleSelectedClass(){document.querySelector(".bubble-selected")&&document.querySelector(".bubble-selected").classList.remove("bubble-selected")}static applyStyle(e,t){const n=e,s=t,o={id:"",class:""};let i;if(n)for(let e=0;e<n.length;e++){for(let t=0;t<n[e].length;t++)i=Object.keys(o)[t],o[i]=n[e][t];document.getElementById(`${o.id}`).classList.add(...o.class)}if(s)for(let e=0;e<s.length;e++){for(let t=0;t<s[e].length;t++)i=Object.keys(o)[t],o[i]=s[e][t];let t=0;const n=document.getElementById(`${o.id}`);for(const e of n.children)o.class[t].length>0&&e.classList.add(...o.class[t]),t++}}static updateLiNumber(e){if(""!==document.querySelector("ul").innerHTML){const t=document.querySelectorAll("li"),n=Math.abs(t.length-e.length);let o;if(t.length<e.length)for(let e=0;e<n;e++)o=document.createElement("li"),o.addEventListener("click",s.applyBubbleSelectedClass),document.querySelector("ul").insertAdjacentElement("beforeend",o);else if(t.length>e.length)for(let e=0;e<n;e++)t[e].remove()}else{const t=document.querySelector("ul");for(let n=0;n<e.length;n++)t.insertAdjacentHTML("beforeend","<li></li>")}}static clearClass(e,t){if(e)for(let t=0;t<e.length;t++)document.getElementById(`${e[t]}`).setAttribute("class","");if(t){let e;for(let n=0;n<t.length;n++){e=document.getElementById(`${t[n]}`);for(const t of e.children)t.setAttribute("class","")}}}static disableButton(e,t,n){const s=document.getElementById(`${e}`);s.disabled=!0,s.classList.add(`${t}`),s.classList.contains(n)&&s.classList.remove(`${n}`)}static giveResponseFeedback(){this.toggleBubbleUnclickable();const e=document.querySelector(".bubble-selected");this.buttonClicked?(e.classList.toggle("bubble-selected"),e.textContent===n.currentQuestion.correctAnswer?(e.classList.toggle("block2__bubble--correctAnswer"),u.scorePage.incrementScore()):e.textContent!==n.currentQuestion.correctAnswer&&(e.classList.toggle("block2__bubble--wrongAnswer"),n.fetchCorrectAnswer())):(n.fetchCorrectAnswer(),this.buttonClicked=!0)}static toggleBubbleUnclickable(){const e=document.querySelectorAll("li");for(const t of e)t.classList.toggle("block2__bubble--unclickable")}static removeResponseFeedBack(){document.querySelector(".bubble-selected")&&document.querySelector(".bubble-selected").classList.toggle("bubble-selected"),document.querySelector(".block2__bubble--correctAnswer").classList.toggle("block2__bubble--correctAnswer"),document.querySelector(".block2__bubble--wrongAnswer")&&document.querySelector(".block2__bubble--wrongAnswer").classList.toggle("block2__bubble--wrongAnswer")}}class o{constructor(e,t,n){this.timerState=e,this.totalSeconds=t,this.speed=n}}class i{constructor(){this.countdownObj}static createCountdownObj(){this.countdownObj=new o("",20,1e3)}static launchCountdown(){this.countdownObj||this.createCountdownObj();const e=document.getElementById("countdown_timer"),t=document.getElementById("countdown_outer-circle");let n,o=i.countdownObj.totalSeconds;const l=i.countdownObj.speed;e.textContent="20",t.style.background="orange",n=setInterval((()=>{o--,e.textContent=`${o}`,t.style.background=`\n                            conic-gradient(\n                                orange ${18*o}deg, \n                                rgba(255, 166, 0, 0.541) ${18*o}deg\n                            )\n                        `,"0"===e.textContent&&(s.buttonClicked=!1,this.stopCountdown(n),u.gamePage.pagesHandler())}),l),document.getElementById("button").addEventListener("click",this.stopCountdown.bind(null,n))}static stopCountdown(e){clearInterval(e)}}class l{constructor(e,t){this.containerId=e,this.lilist=t}renderGamePage(){this.addMissingPageElements(),s.clearClass(["page","sub-container2"],["sub-container2","list"]),s.updateLiNumber(this.lilist),s.applyStyle([["page",["game-page"]],["sub-container1",["block1","flex"]],["sub-container2",["block2","flex"]]],[["sub-container1",[["block1__countdown"],["block1__qust-counter"]]],["countdown",[["countdown_outer-circle"]]],["countdown_outer-circle",[["countdown_inner-circle"]]],["countdown_inner-circle",[["countdown_timer"]]],["question-count",[["qust-counter-p1"],["qust-counter-p2"]]],["sub-container2",[["block2__question"],[],[]]],["list",[["block2__bubble"],["block2__bubble"],["block2__bubble"],["block2__bubble"]]]]),s.disableButton("button","block2__button--disabled","block2__button--enabled"),s.buttonClicked=!0,n.lauchQuestionHandler(),i.launchCountdown(),u.scorePage.initScore(),document.getElementById("button").addEventListener("click",this.pagesHandler.bind(this))}addMissingPageElements(){document.getElementById(`${this.containerId}`).insertAdjacentHTML("afterbegin",'\n            <div id="sub-container1">\n                <div id="countdown">\n                    <div id="countdown_outer-circle">\n                        <div id="countdown_inner-circle">\n                            <span id="countdown_timer"></span>\n                        </div>\n                    </div>\n                </div>\n                <h3 id="question-count">\n                    <span id="q-count-prt1"></span>\n                    <span id="q-count-prt2">/20</span>\n                </h3>\n            </div>\n        '),document.getElementById("sub-container").id="sub-container2",document.getElementById("tittle").id="question";const e=document.createElement("button");e.textContent="Validate",e.id="button",document.querySelector("button").replaceWith(e)}updateGamePage(){document.getElementById("button").disabled||s.disableButton("button","block2__button--disabled","block2__button--enabled"),s.giveResponseFeedback(),setTimeout((()=>{s.removeResponseFeedBack(),s.toggleBubbleUnclickable(),n.fetchSingleQuestionFromArray(),n.questionDisplayHandler(),i.launchCountdown()}),4e3)}pagesHandler(){n.questionCount+1===n.filteredQuestions.length?(s.disableButton("button","block2__button--disabled","block2__button--enabled"),s.giveResponseFeedback(),setTimeout((()=>{u.scorePage.renderScorePage()}),4e3)):this.updateGamePage()}}class c{constructor(e){this.containerId=e}renderHomePage(){this.renderRootEl(),""!==document.getElementById("page").className&&s.clearClass(["page"],!1),s.applyStyle([["app",["app-pos-relative"]],["page",["page","page"]],["overlay",["flex","flex__gap100","overlay"]],["buttons",["flex","flex-buttons"]]],[["h1",[["h1__prt1"],["h1__prt2"]]],["buttons",[["play-butt"],["rules-butt"]]]])}renderRootEl(){document.getElementById(`${this.containerId}`).innerHTML='\n            <div id="overlay">\n                <h1 id="h1" class="h1">\n                    <span id="h1__part1">Let\'s</span> \n                    <span id="h1__part2">Quizz</span>\n                </h1>\n                <div id="buttons">\n                    <button id="play">Play</button>\n                    <button id="rules">Rules</button>\n                </div>\n            </div>\n        ',document.getElementById("play").addEventListener("click",(()=>{document.getElementById("play").className="play-butt--active"}));const e=document.getElementById("overlay");document.getElementById("rules").addEventListener("click",this.displayRulesAlert.bind(null,e,"rules-alert")),document.getElementById("play").addEventListener("click",u.topicPage.renderSettingPage.bind(u.topicPage))}displayRulesAlert(e,t){const n=document.getElementById(`${t}`).content.cloneNode(!0);e.appendChild(n),s.applyStyle([[`${e.id}`,["overlay__show-up"]],["alert-box",["alert-box","flex","flex__space-ev"]]],[["alert-box",[["alert-box__tittle"],["alert-box__message"],["alert-box__butt"]]]]),document.getElementById("alert-butt").addEventListener("click",(()=>{document.getElementById("overlay").classList.remove("overlay__show-up"),document.getElementById("alert-box").remove()}))}}class r{constructor(e){this.containerId=e,this.score}initScore(){this.score=0}renderScorePage(){this.render(),s.clearClass(["page"]),s.applyStyle([["page",["page","flex","flex__space-ev"]],["appreciation",["appreciation"]],["score",["score"]],["home-page-butt",["homePage-butt"]]],!1)}render(){document.getElementById(`${this.containerId}`).innerHTML=`\n                <h2 id="appreciation">Quiz terminated!</h2>\n                <p id="score">Number of good response(s):<span> ${u.scorePage.score}</span></p>\n                <button id="home-page-butt">Home Page</button>\n        `,document.getElementById("home-page-butt").addEventListener("click",u.homePage.renderHomePage.bind(u.homePage))}incrementScore(){this.score++}}class a{constructor(e,t,n,s){this.mainContainerId=e,this.h2TextContent=t,this.lilist=n,this.buttonTextContent=s,this.subContainerId}renderSettingPage(){setTimeout((()=>{document.getElementById("app").classList.remove("app-pos-relative"),s.clearClass(["page"]),this.createSubContainer(this.mainContainerId),this.renderRootEl(this.subContainerId),s.updateLiNumber(this.lilist),s.makeBubbleSelectable(),this.addStaticTextContent(this.h2TextContent,this.lilist,this.buttonTextContent),s.applyStyle([["page",["page"]],["sub-container",["card","flex","flex__space-ev"]],["tittle",["card__tittle","flex"]]],[["list",[["card__bubble"],["card__bubble"],["card__bubble"],["card__bubble"],["card__bubble"]]]]),s.disableButton("button","card__button--disabled","card__button--enabled"),document.getElementById("button").addEventListener("click",this.configGameTopic.bind(this)),document.getElementById("button").addEventListener("click",u.levelPage.updateSettingPage.bind(u.levelPage)),document.querySelector("footer").classList.add("footer-d-none")}),1500)}createSubContainer(e){const t=document.createElement("div");t.id="sub-container",this.subContainerId=t.id;const n=document.getElementById(`${e}`);n.innerHTML="",n.appendChild(t)}renderRootEl(e){document.querySelector("h2")||(document.getElementById(e).innerHTML="\n                <h2 id='tittle'></h2>\n                <ul id='list'></ul>\n                <button id='button'></button>\n            ",s.disableButton("button","card__button--disabled"))}addStaticTextContent(e,t,n){document.querySelector("h2").textContent=e;const s=document.querySelectorAll("li");for(let e=0;e<s.length;e++)s[e].textContent=t[e];document.querySelector("button").textContent=n}updateSettingPage(){s.updateLiNumber(this.lilist),s.removeBubbleSelectedClass(),this.addStaticTextContent(this.h2TextContent,this.lilist,this.buttonTextContent),this.updateButton()}configGameTopic(){let e=document.querySelector(".bubble-selected").textContent;e=e.toLowerCase(),this.topic=e.replaceAll(" ","_")}configGameLevel(){let e=document.querySelector(".bubble-selected").textContent;e=e.toLowerCase(),this.level=e.replaceAll(" ","_")}updateButton(){const e=document.createElement("button");e.id="button",e.textContent="Start",document.getElementById("button").replaceWith(e),e.addEventListener("click",this.configGameLevel.bind(this)),e.addEventListener("click",u.gamePage.renderGamePage.bind(u.gamePage)),s.disableButton("button","card__button--disabled","card__button--enabled")}}class u{constructor(){this.homePage,this.topicPage,this.levelPage,this.gamePage,this.scorePage}static createPagesObj(){this.homePage=new c("page"),this.topicPage=new a("page","Topics",["Film and Tv","Science","General Klg","History","Music"],"Next"),this.levelPage=new a("page","Levels",["Easy","Medium","Hard"],"Next"),this.gamePage=new l("page",["","","",""]),this.scorePage=new r("page")}static init(){this.createPagesObj(),this.homePage.renderHomePage()}}u.init()})();